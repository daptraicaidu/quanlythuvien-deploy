import{r as t,j as a}from"./index-CRlUMUKW.js";import{s as T,u as k,a as f}from"./toastUpdating-DHhL3DLh.js";const I=()=>{const[r,j]=t.useState([]),[p,m]=t.useState(!0),[l,h]=t.useState(null),[d,u]=t.useState(1),[o,g]=t.useState(1),[v,S]=t.useState(0);console.log(v);const[s,x]=t.useState(1),P=async()=>{const e=localStorage.getItem("token");let c;setTimeout(()=>{c=T("Äang táº£i lá»‹ch sá»­ vi pháº¡m...")},0);try{const n=new URLSearchParams;n.append("page",s.toString());const i=await(await fetch(`http://localhost:8080/viPham/getViPhamForUser?${n.toString()}`,{headers:{Authorization:`Bearer ${e}`}})).json();j(i.data),u(i.totalPages||1),g(i.currentPage||1),S(i.totalItems||0),k(c,"SUCCESSFULLY!")}catch(n){f(c,"UNDEFINED ERROR!"),console.error("Lá»—i khi gá»i API vi pháº¡m:",n)}finally{m(!1)}};t.useEffect(()=>{g(s),P()},[s]);const b=()=>{s>1&&x(e=>e-1)},N=()=>{x(e=>e+1)};return a.jsxs("div",{className:"violation-container",children:[a.jsx("h1",{className:"violation-title",children:"ðŸ“š Lá»‹ch Sá»­ Vi Pháº¡m"}),p?a.jsx("p",{className:"violation-loading",children:"Äang táº£i dá»¯ liá»‡u..."}):r.length===0?a.jsx("p",{className:"violation-empty",children:"Báº¡n chÆ°a cÃ³ vi pháº¡m nÃ o."}):a.jsxs("table",{className:"violation-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"MÃ£ sÃ¡ch CB"}),a.jsx("th",{children:"áº¢nh bÃ¬a"}),a.jsx("th",{children:"TÃªn sÃ¡ch"}),a.jsx("th",{children:"MÃ´ táº£"}),a.jsx("th",{children:"HÃ¬nh thá»©c xá»­ lÃ½"}),a.jsx("th",{children:"Tiá»n pháº¡t"}),a.jsx("th",{children:"NgÃ y vi pháº¡m"})]})}),a.jsx("tbody",{children:r.map(e=>a.jsxs("tr",{children:[a.jsx("td",{children:e.idSachCaBiet}),a.jsx("td",{className:"bookcover-cell",children:a.jsx("div",{className:"bookcover-tooltip-wrapper",children:a.jsx("img",{src:`data:image/jpeg;base64,${e.anhBia}`,alt:"áº¢nh bÃ¬a",className:"violation-img",onClick:()=>h(e.anhBia?`data:image/jpeg;base64,${e.anhBia}`:"/images/def-cover.png")})})}),a.jsx("td",{children:e.tenSach}),a.jsx("td",{children:e.moTa}),a.jsx("td",{children:e.hinhThucXuLy}),a.jsxs("td",{children:[(e.tienPhat*1e3).toLocaleString("vi-VN"),"Ä‘"]}),a.jsx("td",{children:e.ngayViPham})]},e.idChiTietPhieuMuon))})]}),a.jsxs("div",{className:"pagination-user",children:[a.jsx("button",{onClick:b,disabled:o===1,children:"Trang trÆ°á»›c"}),a.jsxs("span",{children:["Trang ",o," / ",d]}),a.jsx("button",{onClick:N,disabled:o>=d,children:"Trang sau"})]}),l&&a.jsx("div",{className:"overlay-bookmgmt",onClick:()=>h(null),children:a.jsx("div",{className:"bookcover-preview",onClick:e=>e.stopPropagation(),children:a.jsx("img",{src:l,alt:"book preview"})})})]})};export{I as default};
