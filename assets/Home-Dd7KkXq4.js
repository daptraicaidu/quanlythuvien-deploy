import{u as q,r as t,a as z,j as s,F as B,t as G}from"./index-Dlb-Vogc.js";import{g as H}from"./bookMgmtApi-CBgZA6vP.js";import{s as I,u as K,a as U}from"./toastUpdating-eMtTc5eb.js";import{c as _}from"./createLucideIcon-CvUPftRB.js";/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],O=_("funnel",M),V=()=>{const f=q(),[c,p]=t.useState({keyword:"",theLoais:[]}),[v,N]=t.useState([]),[i,l]=t.useState([]),[T,r]=t.useState(!1),[x,S]=t.useState(1),[h,g]=t.useState(1),[n,d]=t.useState(1),[L,b]=t.useState(0),u=t.useRef(null),m=t.useRef(null);t.useEffect(()=>{const e=a=>{const o=a.target;u.current&&!u.current.contains(o)&&m.current&&!m.current.contains(o)&&r(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),t.useEffect(()=>{A(),g(n),F()},[n,c]);const k=e=>{i.includes(e)?l(a=>a.filter(o=>o!==e)):l(a=>[...a,e])},y=()=>{p({...c,theLoais:i}),r(!1)},C=()=>{l([])},[j,w]=t.useState(""),[E,P]=t.useState([]),F=async()=>{let e;setTimeout(()=>{e=I("Đang tải sách...")},0);try{const a=await H({...c,page:n});P(a.data||[]),S(a.totalPages||1),g(a.currentPage||1),b(a.totalElements||0),K(e,"Loaded Successfully!")}catch(a){console.error("Lỗi khi fetch sách:",a),U(e,"Không kết nối được đến máy chủ.")}},A=async()=>{try{const e=await z.get("http://localhost:8080/theLoai/getAll");N(e.data)}catch(e){console.error("Lỗi fetch thể loại",e)}},R=()=>{n>1&&d(e=>e-1)},$=()=>{d(e=>e+1)};return s.jsxs("div",{className:"home-container",children:[s.jsxs("h1",{className:"title-home",children:["Khám phá kho sách bất tận của chúng tôi (",L,") 📚✨"]}),s.jsxs("div",{className:"search-bar-home",children:[s.jsxs("div",{className:"search-input-wrapper",children:[s.jsx("input",{type:"text",placeholder:"Tìm kiếm sách theo tên, tác giả, nhà xuất bản...",value:j,onChange:e=>w(e.target.value)}),s.jsx("button",{className:"search-button-inside",onClick:()=>{d(1),p({...c,keyword:j})},children:s.jsx(B,{})})]}),s.jsxs("div",{className:"filter-wrapper",children:[s.jsx("button",{ref:m,className:"filter-icon-home",title:"Lọc theo thể loại",onClick:()=>r(e=>!e),children:s.jsx(O,{size:15})}),T&&s.jsxs("div",{ref:u,className:"popup-theloai",children:[s.jsx("div",{className:"popup-arrow"}),s.jsx("div",{className:"theloai-list",children:v.map(e=>s.jsx("div",{className:`theloai-item ${i.includes(e)?"selected":""}`,onClick:()=>k(e),children:e},e))}),s.jsxs("div",{className:"theloai-actions",children:[s.jsx("button",{onClick:C,className:"clear-button",children:"❌ Xoá chọn"}),s.jsx("button",{onClick:y,className:"apply-button",children:"✅ Tìm kiếm"})]})]})]})]}),s.jsx("div",{className:"book-grid-home",children:E.map(e=>s.jsxs("div",{className:"book-card-home",children:[s.jsx("div",{className:"book-image-home",children:s.jsx("img",{src:`data:image/jpeg;base64,${e.anhBia}`,alt:e.tenSach})}),s.jsxs("div",{className:"book-info-home",children:[s.jsx("h3",{children:e.tenSach}),s.jsx("p",{children:e.tacGia})]}),s.jsx("div",{className:"overlay-home",children:s.jsxs("button",{className:"detail-button-home",onClick:()=>f(`/chitietsach/${e.id}/${G(e.tenSach)}`),children:[s.jsx("img",{src:"/quanlythuvien-deploy/images/info.png",alt:"info",className:"icon-home-detail"}),"Chi tiết"]})})]},e.id))}),s.jsxs("div",{className:"pagination-book",children:[s.jsx("button",{onClick:R,disabled:h===1,children:"Trang trước"}),s.jsxs("span",{children:["Trang ",h," / ",x]}),s.jsx("button",{onClick:$,disabled:h>=x,children:"Trang sau"})]})]})};export{V as default};
