import{r as n,j as e,l as B}from"./index-Dlb-Vogc.js";import{s as E,u as M,a as $}from"./toastUpdating-eMtTc5eb.js";import{c as v}from"./createLucideIcon-CvUPftRB.js";/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],A=v("chevron-down",D);/**
 * @license lucide-react v0.537.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],_=v("chevron-right",V),H=()=>{const[r,T]=n.useState([]),[a,c]=n.useState([]),[x,g]=n.useState(null),[w,b]=n.useState(!0),[i,d]=n.useState([]),[j,y]=n.useState(1),[h,m]=n.useState(1),[S,f]=n.useState(0);console.log(S);const[o,u]=n.useState(1),k=async()=>{let s;setTimeout(()=>{s=E("Äang táº£i lá»‹ch sá»­ mÆ°á»£n sÃ¡ch...")},0);try{const t=localStorage.getItem("token"),N=new URLSearchParams;N.append("page",o.toString());const l=await(await fetch(`http://localhost:8080/phieuMuon/lichSuMuon?${N.toString()}`,{headers:{Authorization:`Bearer ${t}`}})).json();T(l.data),y(l.totalPages||1),m(l.currentPage||1),f(l.totalItems||0),M(s,"Loaded successfully")}catch(t){console.error("Lá»—i fetch lá»‹ch sá»­ mÆ°á»£n:",t),$(s,"UNDEFINED ERROR.")}finally{b(!1)}};n.useEffect(()=>{const s=async()=>{await k(),c([]),d([])};m(o),s()},[o]);const C=()=>{o>1&&u(s=>s-1)},L=()=>{u(s=>s+1)},P=s=>{a.includes(s)?(d([...i,s]),setTimeout(()=>{c(a.filter(t=>t!==s)),d(i.filter(t=>t!==s))},250)):c([...a,s])},R=()=>{c(p?[]:r.map(s=>s.id))},p=a.length>0,I=p?"Thu gá»n táº¥t cáº£":"Má»Ÿ táº¥t cáº£";return e.jsxs("div",{className:"borrow-history-container",children:[e.jsxs("div",{className:"borrow-history-header",children:[e.jsx("h2",{className:"borrow-history-title",children:"ðŸ“š Lá»‹ch sá»­ mÆ°á»£n sÃ¡ch"}),e.jsx("button",{className:"expand-all-button",onClick:R,children:I})]}),w?e.jsx("p",{className:"violation-loading",children:"Äang táº£i dá»¯ liá»‡u..."}):r.length===0?e.jsx("p",{className:"violation-empty",children:"Báº¡n chÆ°a lá»‹ch sá»­ mÆ°á»£n sÃ¡ch nÃ o."}):e.jsxs("table",{className:"borrow-history-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"NgÃ y mÆ°á»£n"}),e.jsx("th",{children:"Tá»•ng tiá»n mÆ°á»£n"}),e.jsx("th",{children:"Tiá»n cá»c cÃ²n láº¡i"})]})}),e.jsx("tbody",{children:r.map(s=>e.jsxs(B.Fragment,{children:[e.jsxs("tr",{className:`main-row ${a.includes(s.id)&&!i.includes(s.id)?"row-expanded":""}`,onClick:()=>P(s.id),children:[e.jsxs("td",{className:"id-cell",children:[e.jsx("span",{className:"expand-icon-wrapper",children:e.jsx("span",{className:`expand-icon ${a.includes(s.id)?"expanded":"wiggle"}`,children:a.includes(s.id)?e.jsx(A,{size:18}):e.jsx(_,{size:18})})}),s.id]}),e.jsx("td",{children:s.ngayMuon}),e.jsxs("td",{children:[(s.tongTienMuon*1e3).toLocaleString("vi-VN"),"Ä‘"]}),e.jsxs("td",{children:[(s.tienCocConLai*1e3).toLocaleString("vi-VN"),"Ä‘"]})]}),a.includes(s.id)&&e.jsx("tr",{className:`expand-container ${i.includes(s.id)?"closing":""}`,children:e.jsx("td",{colSpan:4,children:e.jsx("div",{className:"expand-animation",children:e.jsxs("table",{className:"nested-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"MÃ£ sÃ¡ch CB"}),e.jsx("th",{children:"áº¢nh bÃ¬a"}),e.jsx("th",{children:"TÃªn sÃ¡ch"}),e.jsx("th",{children:"NgÃ y tráº£ dá»± kiáº¿n"}),e.jsx("th",{children:"NgÃ y tráº£ thá»±c táº¿"}),e.jsx("th",{children:"Tiá»n mÆ°á»£n"}),e.jsx("th",{children:"Tiá»n cá»c"}),e.jsx("th",{children:"Tiá»n pháº¡t"})]})}),e.jsx("tbody",{children:s.chiTietPhieuMuons.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.idSachCaBiet}),e.jsx("td",{className:"bookcover-cell",children:e.jsx("div",{className:"bookcover-tooltip-wrapper",children:e.jsx("img",{src:`data:image/jpeg;base64,${t.anhBia}`,alt:"áº¢nh bÃ¬a",className:"violation-img",onClick:()=>g(t.anhBia?`data:image/jpeg;base64,${t.anhBia}`:"/quanlythuvien-deploy/images/def-cover.png")})})}),e.jsx("td",{children:t.tenSach}),e.jsx("td",{children:t.ngayTra}),e.jsx("td",{children:t.ngayTraThucTe?t.ngayTraThucTe:"---"}),e.jsxs("td",{children:[(t.tienMuon*1e3).toLocaleString("vi-VN"),"Ä‘"]}),e.jsxs("td",{children:[(t.tienCoc*1e3).toLocaleString("vi-VN"),"Ä‘"]}),e.jsxs("td",{children:[(t.tienPhat*1e3).toLocaleString("vi-VN"),"Ä‘"]})]},t.idSachCaBiet))})]})})})})]},s.id))})]}),e.jsxs("div",{className:"pagination-user",children:[e.jsx("button",{onClick:C,disabled:h===1,children:"Trang trÆ°á»›c"}),e.jsxs("span",{children:["Trang ",h," / ",j]}),e.jsx("button",{onClick:L,disabled:h>=j,children:"Trang sau"})]}),x&&e.jsx("div",{className:"overlay-bookmgmt",onClick:()=>g(null),children:e.jsx("div",{className:"bookcover-preview",onClick:s=>s.stopPropagation(),children:e.jsx("img",{src:x,alt:"book preview"})})})]})};export{H as default};
